<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
        #ui { position: absolute; top: 20px; left: 20px; z-index: 999; color: #00F2FF; font-family: sans-serif; font-size: 24px; text-shadow: 2px 2px #000; }
        #trivia { display: none; position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); color: white; padding: 20px; border-radius: 15px; text-align: center; z-index: 999; width: 80%; border: 2px solid #7B4BB1; }
        button { background: #7B4BB1; color: white; border: none; padding: 12px 25px; margin: 10px; border-radius: 8px; font-weight: bold; }
    </style>
</head>
<body>
    <div id="ui">POINTS: <span id="score">0</span></div>
    
    <div id="trivia">
        <h3>EKO CHALLENGE</h3>
        <p>What color is EKO's jacket?</p>
        <button onclick="ans(true)">PURPLE</button>
        <button onclick="ans(false)">RED</button>
    </div>

    <a-scene mindar-image="imageTargetSrc: ./targets.mind; autoStart: true; uiLoading: no;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
        <a-assets>
            <a-asset-item id="ekoModel" src="./eko_dance.glb"></a-asset-item>
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="far: 10000; objects: .clickable"></a-camera>

        <a-entity id="eko-anchor" mindar-image-target="targetIndex: 0">
            <a-gltf-model id="eko-model" src="#ekoModel" rotation="90 0 0" position="0 0 0" scale="0.5 0.5 0.5" animation-mixer="clip: *; loop: repeat;"></a-gltf-model>
        </a-entity>
    </a-scene>

    <script>
        let score = 0;
        const anchorEl = document.querySelector('#eko-anchor');
        const modelEl = document.querySelector('#eko-model');

        // Detecting the Mascot
        anchorEl.addEventListener("targetFound", event => {
            if(score === 0) {
                score = 5;
                document.getElementById('score').innerText = score;
                document.getElementById('trivia').style.display = 'block';
            }
        });

        window.ans = (correct) => {
            if(correct) {
                score += 15;
                // Animation triggers automatically with 'animation-mixer'
            }
            document.getElementById('score').innerText = score;
            document.getElementById('trivia').style.display = 'none';
        }
    </script>
</body>
</html>
